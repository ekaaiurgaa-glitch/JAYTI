{% extends 'base.html' %}
{% load static %}

{% block title %}My Diary - jayti{% endblock %}

{% block extra_css %}
<style>
    .diary-header {
        background: linear-gradient(135deg, rgba(244,194,194,0.2), rgba(230,230,250,0.2));
        border-radius: 20px;
        padding: 2rem;
        margin-bottom: 2rem;
    }
    
    .streak-badge {
        background: linear-gradient(135deg, var(--blush-rose), var(--dusty-rose));
        color: white;
        padding: 1rem 1.5rem;
        border-radius: 16px;
        text-align: center;
    }
    
    .streak-number {
        font-size: 2.5rem;
        font-weight: 700;
        font-family: 'Playfair Display', serif;
        line-height: 1;
    }
    
    .stat-card {
        background: white;
        border-radius: 16px;
        padding: 1.25rem;
        text-align: center;
        box-shadow: 0 4px 15px rgba(0,0,0,0.05);
        transition: all 0.3s ease;
    }
    
    .stat-card:hover {
        transform: translateY(-3px);
        box-shadow: 0 8px 25px rgba(0,0,0,0.08);
    }
    
    .stat-icon {
        width: 50px;
        height: 50px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        margin: 0 auto 0.75rem;
        font-size: 1.25rem;
    }
    
    .entry-card {
        background: white;
        border-radius: 16px;
        padding: 1.5rem;
        margin-bottom: 1rem;
        box-shadow: 0 4px 15px rgba(0,0,0,0.05);
        transition: all 0.3s ease;
        border-left: 4px solid transparent;
    }
    
    .entry-card:hover {
        transform: translateX(5px);
        box-shadow: 0 6px 20px rgba(0,0,0,0.08);
        border-left-color: var(--blush-rose);
    }
    
    .entry-date {
        font-family: 'Playfair Display', serif;
        color: var(--dusty-rose);
        font-size: 1.1rem;
        font-weight: 600;
    }
    
    .entry-preview {
        color: var(--muted-mauve);
        font-size: 0.9rem;
        line-height: 1.6;
        display: -webkit-box;
        -webkit-line-clamp: 2;
        -webkit-box-orient: vertical;
        overflow: hidden;
    }
    
    .mood-indicator {
        display: inline-flex;
        align-items: center;
        gap: 0.5rem;
        padding: 0.35rem 0.875rem;
        border-radius: 20px;
        font-size: 0.8rem;
        font-weight: 500;
    }
    
    .mood-1 { background: rgba(220, 53, 69, 0.1); color: #dc3545; }
    .mood-2 { background: rgba(253, 126, 20, 0.1); color: #fd7e14; }
    .mood-3 { background: rgba(108, 117, 125, 0.1); color: #6c757d; }
    .mood-4 { background: rgba(40, 167, 69, 0.1); color: #28a745; }
    .mood-5 { background: rgba(32, 201, 151, 0.1); color: #20c997; }
    
    .action-card {
        background: white;
        border-radius: 16px;
        padding: 1.5rem;
        text-align: center;
        box-shadow: 0 4px 15px rgba(0,0,0,0.05);
        transition: all 0.3s ease;
        height: 100%;
        text-decoration: none;
        color: inherit;
        display: block;
    }
    
    .action-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 12px 30px rgba(0,0,0,0.1);
        color: inherit;
    }
    
    .action-icon {
        width: 70px;
        height: 70px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        margin: 0 auto 1rem;
        font-size: 1.75rem;
        transition: all 0.3s ease;
    }
    
    .action-card:hover .action-icon {
        transform: scale(1.1);
    }
    
    .write-icon { background: linear-gradient(135deg, #F4C2C2, #E6A8A8); color: white; }
    .calendar-icon { background: linear-gradient(135deg, #E6E6FA, #D4D4F0); color: var(--muted-mauve); }
    .summary-icon { background: linear-gradient(135deg, #F0FFF0, #D0F0D0); color: #5a8a5a; }
    
    .empty-state {
        text-align: center;
        padding: 3rem 2rem;
        background: white;
        border-radius: 20px;
        box-shadow: 0 4px 15px rgba(0,0,0,0.05);
    }
    
    .empty-icon {
        width: 100px;
        height: 100px;
        border-radius: 50%;
        background: linear-gradient(135deg, rgba(244,194,194,0.2), rgba(230,230,250,0.2));
        display: flex;
        align-items: center;
        justify-content: center;
        margin: 0 auto 1.5rem;
        font-size: 2.5rem;
        color: var(--dusty-rose);
    }
    
    .section-title {
        font-family: 'Playfair Display', serif;
        color: var(--warm-charcoal);
        font-size: 1.25rem;
        margin-bottom: 1rem;
        display: flex;
        align-items: center;
        gap: 0.5rem;
    }
    
    .view-all-link {
        color: var(--dusty-rose);
        text-decoration: none;
        font-size: 0.9rem;
        font-weight: 500;
        transition: all 0.2s ease;
    }
    
    .view-all-link:hover {
        color: var(--blush-rose);
        text-decoration: underline;
    }
</style>
{% endblock %}

{% block content %}
<div class="container py-4">
    <!-- Header Section -->
    <div class="diary-header animate-fade-in">
        <div class="row align-items-center">
            <div class="col-md-8">
                <h1 class="font-script mb-2" style="font-size: 2.5rem; color: var(--dusty-rose);">My Diary</h1>
                <p class="text-mauve mb-0" style="font-size: 1rem;">
                    <i class="fas fa-feather-alt me-2"></i>
                    Capture your thoughts, track your mood, and reflect on your journey
                </p>
            </div>
            <div class="col-md-4 mt-3 mt-md-0">
                <div class="streak-badge">
                    <div class="streak-number">{{ streak_days|default:0 }}</div>
                    <div style="font-size: 0.9rem; opacity: 0.9;">
                        <i class="fas fa-fire me-1"></i>Day Streak
                    </div>
                </div>
            </div>
        </div>
    </div>
    
    <!-- Quick Actions -->
    <div class="row g-4 mb-4 animate-fade-in">
        <div class="col-md-4">
            <a href="{% url 'diary_write' %}" class="action-card">
                <div class="action-icon write-icon">
                    <i class="fas fa-pen-fancy"></i>
                </div>
                <h5 class="mb-2">Write Today</h5>
                <p class="text-mauve mb-0" style="font-size: 0.85rem;">Capture your thoughts and feelings for today</p>
            </a>
        </div>
        <div class="col-md-4">
            <a href="{% url 'diary_calendar' %}" class="action-card">
                <div class="action-icon calendar-icon">
                    <i class="fas fa-calendar-alt"></i>
                </div>
                <h5 class="mb-2">View Calendar</h5>
                <p class="text-mauve mb-0" style="font-size: 0.85rem;">See your entries organized by date</p>
            </a>
        </div>
        <div class="col-md-4">
            <a href="{% url 'diary_summary' %}" class="action-card">
                <div class="action-icon summary-icon">
                    <i class="fas fa-chart-line"></i>
                </div>
                <h5 class="mb-2">Insights</h5>
                <p class="text-mauve mb-0" style="font-size: 0.85rem;">Weekly and monthly mood summaries</p>
            </a>
        </div>
    </div>
    
    <!-- Stats Row -->
    <div class="row g-3 mb-4">
        <div class="col-6 col-md-3">
            <div class="stat-card">
                <div class="stat-icon" style="background: linear-gradient(135deg, rgba(244,194,194,0.2), rgba(230,230,250,0.2)); color: var(--dusty-rose);">
                    <i class="fas fa-book-open"></i>
                </div>
                <div class="h4 mb-1" style="color: var(--warm-charcoal);">{{ total_entries|default:0 }}</div>
                <small class="text-mauve">Total Entries</small>
            </div>
        </div>
        <div class="col-6 col-md-3">
            <div class="stat-card">
                <div class="stat-icon" style="background: linear-gradient(135deg, rgba(40,167,69,0.15), rgba(32,201,151,0.15)); color: #28a745;">
                    <i class="fas fa-smile"></i>
                </div>
                <div class="h4 mb-1" style="color: var(--warm-charcoal);">{{ avg_mood|default:"-" }}</div>
                <small class="text-mauve">Avg Mood</small>
            </div>
        </div>
        <div class="col-6 col-md-3">
            <div class="stat-card">
                <div class="stat-icon" style="background: linear-gradient(135deg, rgba(255,218,185,0.3), rgba(244,194,194,0.2)); color: #e6a85c;">
                    <i class="fas fa-calendar-check"></i>
                </div>
                <div class="h4 mb-1" style="color: var(--warm-charcoal);">{{ this_month_count|default:0 }}</div>
                <small class="text-mauve">This Month</small>
            </div>
        </div>
        <div class="col-6 col-md-3">
            <div class="stat-card">
                <div class="stat-icon" style="background: linear-gradient(135deg, rgba(230,230,250,0.4), rgba(212,212,240,0.3)); color: var(--muted-mauve);">
                    <i class="fas fa-clock"></i>
                </div>
                <div class="h4 mb-1" style="color: var(--warm-charcoal);">{{ last_entry_days|default:"-" }}</div>
                <small class="text-mauve">Days Since</small>
            </div>
        </div>
    </div>
    
    <!-- Recent Entries -->
    <div class="row">
        <div class="col-lg-8">
            <div class="d-flex justify-content-between align-items-center mb-3">
                <h2 class="section-title mb-0">
                    <i class="fas fa-history text-blush"></i>
                    Recent Entries
                </h2>
                <a href="{% url 'diary_calendar' %}" class="view-all-link">
                    View All <i class="fas fa-arrow-right ms-1"></i>
                </a>
            </div>
            
            {% if recent_entries %}
                {% for entry in recent_entries %}
                <div class="entry-card">
                    <div class="row align-items-center">
                        <div class="col-md-8">
                            <div class="entry-date mb-2">
                                <i class="far fa-calendar me-2"></i>{{ entry.entry_date|date:"F d, Y" }}
                            </div>
                            <p class="entry-preview mb-0">{{ entry.content|truncatewords:25 }}</p>
                        </div>
                        <div class="col-md-4 mt-2 mt-md-0 text-md-end">
                            {% if entry.mood %}
                            <span class="mood-indicator mood-{{ entry.mood }}">
                                <i class="fas fa-heart"></i>
                                {% if entry.mood == 1 %}Struggling
                                {% elif entry.mood == 2 %}Difficult
                                {% elif entry.mood == 3 %}Neutral
                                {% elif entry.mood == 4 %}Good
                                {% elif entry.mood == 5 %}Great
                                {% endif %}
                            </span>
                            {% endif %}
                            <a href="{% url 'diary_entry_detail' entry.id %}" class="btn btn-sm btn-outline-primary ms-2 mt-2 mt-md-0" style="font-size: 0.8rem;">
                                <i class="fas fa-eye me-1"></i>Read
                            </a>
                        </div>
                    </div>
                </div>
                {% endfor %}
            {% else %}
                <div class="empty-state">
                    <div class="empty-icon">
                        <i class="fas fa-book"></i>
                    </div>
                    <h4 class="font-script mb-2" style="color: var(--dusty-rose);">Begin Your Journey</h4>
                    <p class="text-mauve mb-3">Your diary is waiting for your first entry. Start writing today!</p>
                    <a href="{% url 'diary_write' %}" class="btn btn-primary">
                        <i class="fas fa-pen me-2"></i>Write First Entry
                    </a>
                </div>
            {% endif %}
        </div>
        
        <!-- Sidebar -->
        <div class="col-lg-4 mt-4 mt-lg-0">
            <div class="card" style="border: none; border-radius: 16px; background: linear-gradient(135deg, rgba(244,194,194,0.1), rgba(230,230,250,0.1));">
                <div class="card-body">
                    <h5 class="font-script mb-3" style="color: var(--dusty-rose);">
                        <i class="fas fa-lightbulb me-2"></i>Writing Tips
                    </h5>
                    <ul class="list-unstyled mb-0" style="font-size: 0.9rem; color: var(--muted-mauve);">
                        <li class="mb-2">
                            <i class="fas fa-check-circle text-blush me-2"></i>
                            Write honestly without judgment
                        </li>
                        <li class="mb-2">
                            <i class="fas fa-check-circle text-blush me-2"></i>
                            Track your mood for insights
                        </li>
                        <li class="mb-2">
                            <i class="fas fa-check-circle text-blush me-2"></i>
                            Use voice when typing feels hard
                        </li>
                        <li class="mb-0">
                            <i class="fas fa-check-circle text-blush me-2"></i>
                            Review past entries monthly
                        </li>
                    </ul>
                </div>
            </div>
            
            {% if todays_entry %}
            <div class="card mt-3" style="border: none; border-radius: 16px; background: linear-gradient(135deg, #F4C2C2, #E6A8A8); color: white;">
                <div class="card-body text-center">
                    <i class="fas fa-check-circle mb-2" style="font-size: 2rem; opacity: 0.9;"></i>
                    <h6 class="mb-1">Today's Entry Complete!</h6>
                    <p class="mb-0" style="font-size: 0.85rem; opacity: 0.9;">Great job keeping your streak alive</p>
                </div>
            </div>
            {% else %}
            <div class="card mt-3" style="border: none; border-radius: 16px; background: linear-gradient(135deg, rgba(255,218,185,0.3), rgba(244,194,194,0.2));">
                <div class="card-body text-center">
                    <i class="fas fa-pen-fancy mb-2 text-blush" style="font-size: 2rem;"></i>
                    <h6 class="mb-1" style="color: var(--warm-charcoal);">Today's Entry</h6>
                    <p class="mb-3 text-mauve" style="font-size: 0.85rem;">You haven't written today yet</p>
                    <a href="{% url 'diary_write' %}" class="btn btn-primary btn-sm">
                        <i class="fas fa-pen me-1"></i>Write Now
                    </a>
                </div>
            </div>
            {% endif %}
        </div>
    </div>
</div>
{% endblock %}
