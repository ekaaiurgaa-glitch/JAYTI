{% extends 'base.html' %}

{% block title %}Diary Summary - JaytiPargal.in{% endblock %}

{% block extra_css %}
<style>
    .summary-header {
        background: linear-gradient(135deg, var(--lavender-mist) 0%, #D4D4F0 100%);
        padding: 3rem 0;
        margin-bottom: 2rem;
        position: relative;
        overflow: hidden;
    }
    
    .summary-header::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background: url("data:image/svg+xml,%3Csvg width='60' height='60' viewBox='0 0 60 60' xmlns='http://www.w3.org/2000/svg'%3E%3Cg fill='none' fill-rule='evenodd'%3E%3Cg fill='%23ffffff' fill-opacity='0.2'%3E%3Cpath d='M36 34v-4h-2v4h-4v2h4v4h2v-4h4v-2h-4zm0-30V0h-2v4h-4v2h4v4h2V6h4V4h-4zM6 34v-4H4v4H0v2h4v4h2v-4h4v-2H6zM6 4V0H4v4H0v2h4v4h2V6h4V4H6z'/%3E%3C/g%3E%3C/g%3E%3C/svg%3E");
        opacity: 0.5;
    }
    
    .summary-title {
        color: var(--warm-charcoal);
        font-size: 2.5rem;
        position: relative;
        z-index: 1;
    }
    
    .summary-subtitle {
        color: var(--muted-mauve);
        font-family: 'Dancing Script', cursive;
        font-size: 1.5rem;
        position: relative;
        z-index: 1;
    }
    
    .stats-card {
        background: white;
        border-radius: 20px;
        padding: 2rem;
        box-shadow: 0 4px 20px rgba(0,0,0,0.06);
        transition: all 0.3s ease;
        height: 100%;
    }
    
    .stats-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 12px 40px rgba(212,165,165,0.15);
    }
    
    .stats-icon {
        width: 60px;
        height: 60px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1.5rem;
        margin-bottom: 1rem;
    }
    
    .stats-icon.blue {
        background: linear-gradient(135deg, #E6E6FA, #D4D4F0);
        color: #6B5B95;
    }
    
    .stats-icon.pink {
        background: linear-gradient(135deg, #F4C2C2, #E6A8A8);
        color: #8B5A5A;
    }
    
    .stats-icon.green {
        background: linear-gradient(135deg, #F0FFF0, #D0F0D0);
        color: #5A8B5A;
    }
    
    .stats-number {
        font-size: 2.5rem;
        font-weight: 700;
        color: var(--warm-charcoal);
        margin-bottom: 0.5rem;
    }
    
    .stats-label {
        color: var(--muted-mauve);
        font-size: 0.95rem;
    }
    
    .mood-indicator {
        display: inline-flex;
        align-items: center;
        gap: 0.5rem;
        padding: 0.75rem 1.5rem;
        border-radius: 30px;
        font-weight: 600;
    }
    
    .mood-great {
        background: linear-gradient(135deg, #90EE90, #7FDD7F);
        color: white;
    }
    
    .mood-good {
        background: linear-gradient(135deg, #98D8C8, #7FC8B8);
        color: white;
    }
    
    .mood-neutral {
        background: linear-gradient(135deg, #F0E68C, #E0D67C);
        color: var(--warm-charcoal);
    }
    
    .mood-difficult {
        background: linear-gradient(135deg, #FFB6C1, #FFA0B0);
        color: white;
    }
    
    .mood-struggling {
        background: linear-gradient(135deg, #D3D3D3, #C0C0C0);
        color: var(--warm-charcoal);
    }
    
    .section-title {
        font-size: 1.5rem;
        color: var(--warm-charcoal);
        margin-bottom: 1.5rem;
        display: flex;
        align-items: center;
        gap: 0.75rem;
    }
    
    .section-title i {
        color: var(--dusty-rose);
    }
    
    .entry-list {
        list-style: none;
        padding: 0;
    }
    
    .entry-item {
        background: white;
        border-radius: 16px;
        padding: 1.5rem;
        margin-bottom: 1rem;
        box-shadow: 0 4px 20px rgba(0,0,0,0.06);
        transition: all 0.3s ease;
        display: flex;
        align-items: center;
        gap: 1.5rem;
    }
    
    .entry-item:hover {
        transform: translateY(-3px);
        box-shadow: 0 8px 30px rgba(0,0,0,0.1);
    }
    
    .entry-date {
        background: var(--cream);
        border-radius: 12px;
        padding: 1rem;
        text-align: center;
        min-width: 80px;
    }
    
    .entry-date-day {
        font-size: 1.5rem;
        font-weight: 700;
        color: var(--dusty-rose);
    }
    
    .entry-date-month {
        font-size: 0.85rem;
        color: var(--muted-mauve);
        text-transform: uppercase;
    }
    
    .entry-content {
        flex: 1;
    }
    
    .entry-preview {
        color: var(--warm-charcoal);
        font-size: 1rem;
        margin-bottom: 0.5rem;
        overflow: hidden;
        text-overflow: ellipsis;
        display: -webkit-box;
        -webkit-line-clamp: 2;
        -webkit-box-orient: vertical;
    }
    
    .entry-meta {
        display: flex;
        gap: 1rem;
        font-size: 0.85rem;
        color: var(--muted-mauve);
    }
    
    .entry-mood {
        font-size: 1.5rem;
    }
    
    .empty-state {
        text-align: center;
        padding: 4rem 2rem;
        background: white;
        border-radius: 20px;
    }
    
    .empty-icon {
        font-size: 4rem;
        color: var(--blush-rose);
        margin-bottom: 1.5rem;
    }
    
    .streak-badge {
        background: linear-gradient(135deg, var(--blush-rose), var(--dusty-rose));
        color: white;
        padding: 1rem 2rem;
        border-radius: 20px;
        display: inline-flex;
        align-items: center;
        gap: 0.75rem;
        font-weight: 600;
    }
    
    .streak-badge i {
        font-size: 1.5rem;
    }
</style>
{% endblock %}

{% block content %}
<div class="summary-header">
    <div class="container text-center">
        <h1 class="summary-title mb-2">Diary Summary</h1>
        <p class="summary-subtitle mb-4">Reflect on your journey and patterns</p>
        
        {% if streak > 0 %}
        <div class="streak-badge">
            <i class="fas fa-fire"></i>
            <span>{{ streak }} Day Writing Streak!</span>
        </div>
        {% endif %}
    </div>
</div>

<div class="container">
    <!-- Stats Row -->
    <div class="row g-4 mb-5">
        <div class="col-md-4">
            <div class="stats-card">
                <div class="stats-icon blue">
                    <i class="fas fa-calendar-week"></i>
                </div>
                <div class="stats-number">{{ week_count }}</div>
                <div class="stats-label">Entries This Week</div>
            </div>
        </div>
        <div class="col-md-4">
            <div class="stats-card">
                <div class="stats-icon pink">
                    <i class="fas fa-calendar-alt"></i>
                </div>
                <div class="stats-number">{{ month_count }}</div>
                <div class="stats-label">Entries This Month</div>
            </div>
        </div>
        <div class="col-md-4">
            <div class="stats-card">
                <div class="stats-icon green">
                    <i class="fas fa-smile"></i>
                </div>
                {% if avg_mood %}
                    {% if avg_mood >= 4.5 %}
                    <div class="mood-indicator mood-great mt-2">
                        <span>üòä</span>
                        <span>Great</span>
                    </div>
                    {% elif avg_mood >= 3.5 %}
                    <div class="mood-indicator mood-good mt-2">
                        <span>üôÇ</span>
                        <span>Good</span>
                    </div>
                    {% elif avg_mood >= 2.5 %}
                    <div class="mood-indicator mood-neutral mt-2">
                        <span>üòê</span>
                        <span>Neutral</span>
                    </div>
                    {% elif avg_mood >= 1.5 %}
                    <div class="mood-indicator mood-difficult mt-2">
                        <span>üòï</span>
                        <span>Difficult</span>
                    </div>
                    {% else %}
                    <div class="mood-indicator mood-struggling mt-2">
                        <span>üòî</span>
                        <span>Struggling</span>
                    </div>
                    {% endif %}
                {% else %}
                    <div class="stats-number">-</div>
                {% endif %}
                <div class="stats-label mt-2">Average Mood (Week)</div>
            </div>
        </div>
    </div>

    <div class="row">
        <!-- Weekly Entries -->
        <div class="col-lg-6 mb-4">
            <h2 class="section-title">
                <i class="fas fa-calendar-week"></i>
                This Week's Entries
            </h2>
            {% if week_entries %}
            <ul class="entry-list">
                {% for entry in week_entries %}
                <li class="entry-item">
                    <div class="entry-date">
                        <div class="entry-date-day">{{ entry.entry_date|date:"d" }}</div>
                        <div class="entry-date-month">{{ entry.entry_date|date:"M" }}</div>
                    </div>
                    <div class="entry-content">
                        <div class="entry-preview">{{ entry.content|truncatewords:15|default:"No content..." }}</div>
                        <div class="entry-meta">
                            <span><i class="fas fa-clock me-1"></i>{{ entry.created_at|time:"g:i A" }}</span>
                            {% if entry.input_method == 'voice' %}
                            <span><i class="fas fa-microphone me-1"></i>Voice</span>
                            {% elif entry.input_method == 'stylus' %}
                            <span><i class="fas fa-pen me-1"></i>Handwritten</span>
                            {% else %}
                            <span><i class="fas fa-keyboard me-1"></i>Typed</span>
                            {% endif %}
                        </div>
                    </div>
                    {% if entry.mood %}
                    <div class="entry-mood">
                        {% if entry.mood == 5 %}üòä{% elif entry.mood == 4 %}üôÇ{% elif entry.mood == 3 %}üòê{% elif entry.mood == 2 %}üòï{% else %}üòî{% endif %}
                    </div>
                    {% endif %}
                </li>
                {% endfor %}
            </ul>
            {% else %}
            <div class="empty-state">
                <div class="empty-icon">
                    <i class="fas fa-book-open"></i>
                </div>
                <p class="text-muted">No entries this week yet</p>
                <a href="{% url 'diary_write' %}" class="btn btn-primary mt-3">
                    <i class="fas fa-pen me-2"></i>Write Today
                </a>
            </div>
            {% endif %}
        </div>

        <!-- Monthly Entries -->
        <div class="col-lg-6 mb-4">
            <h2 class="section-title">
                <i class="fas fa-calendar-alt"></i>
                This Month's Entries
            </h2>
            {% if month_entries %}
            <ul class="entry-list">
                {% for entry in month_entries %}
                <li class="entry-item">
                    <div class="entry-date">
                        <div class="entry-date-day">{{ entry.entry_date|date:"d" }}</div>
                        <div class="entry-date-month">{{ entry.entry_date|date:"M" }}</div>
                    </div>
                    <div class="entry-content">
                        <div class="entry-preview">{{ entry.content|truncatewords:15|default:"No content..." }}</div>
                        <div class="entry-meta">
                            <span><i class="fas fa-calendar me-1"></i>{{ entry.entry_date|date:"D" }}</span>
                            {% if entry.mood %}
                            <span>
                                {% if entry.mood == 5 %}üòä Great{% elif entry.mood == 4 %}üôÇ Good{% elif entry.mood == 3 %}üòê Neutral{% elif entry.mood == 2 %}üòï Difficult{% else %}üòî Struggling{% endif %}
                            </span>
                            {% endif %}
                        </div>
                    </div>
                    <a href="{% url 'diary_entry_detail' entry.pk %}" class="btn btn-outline-primary btn-sm">
                        <i class="fas fa-eye"></i>
                    </a>
                </li>
                {% endfor %}
            </ul>
            {% else %}
            <div class="empty-state">
                <div class="empty-icon">
                    <i class="fas fa-book"></i>
                </div>
                <p class="text-muted">No entries this month yet</p>
                <a href="{% url 'diary_write' %}" class="btn btn-primary mt-3">
                    <i class="fas fa-pen me-2"></i>Start Writing
                </a>
            </div>
            {% endif %}
        </div>
    </div>

    <!-- Quick Actions -->
    <div class="row mt-4">
        <div class="col-12">
            <div class="card">
                <div class="card-body text-center py-4">
                    <h4 class="mb-3">Continue Your Journey</h4>
                    <div class="d-flex justify-content-center gap-3 flex-wrap">
                        <a href="{% url 'diary_write' %}" class="btn btn-primary">
                            <i class="fas fa-pen me-2"></i>Write New Entry
                        </a>
                        <a href="{% url 'diary_overview' %}" class="btn btn-outline-primary">
                            <i class="fas fa-list me-2"></i>All Entries
                        </a>
                        <a href="{% url 'diary_calendar' %}" class="btn btn-outline-primary">
                            <i class="fas fa-calendar me-2"></i>Calendar View
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}
